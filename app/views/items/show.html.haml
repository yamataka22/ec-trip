- favorite = current_member&.favorites&.find{|favorite| favorite.item_id == @item.id}
- cart_added = current_member&.carts&.find{|cart| cart.item_id == @item.id}
- content_for :stylesheet do
  = stylesheet_link_tag 'front/item'
.item_show
  .container
    .row.justify-content-lg-center
      .col-lg-11.col-xl-10
        - if cart_added
          .alert.alert-primary
            .clearfix.pt-1
              .float-left
                %p.pt-1.mb-0= params[:cart_added] ? 'カートに追加しました' : 'この商品はカートに追加されています'
              .float-right
                = link_to 'カートを編集', '#', class: 'btn btn-success'
                = link_to 'レジに進む', '#', class: 'btn btn-primary btn-raised'
        .row
          .col-md-8
            .card.item_about.mb-3
              .card-header.text-center
                %h1.h3= @item.name
                %p.text-muted= @item.description
              .card-body
                = @item.about.try(:html_safe)
              .card-footer.text-center.pt-3
                - cart_path = member_signed_in? ? member_carts_path(item_id: @item.id) : new_session_path(:member)
                = link_to cart_path, method: :post, class: 'btn btn-outline-warning mr-3' do
                  %i.fa.fa-fw.fa-cart-plus
                  カートに追加する
                = link_to items_path, class: 'btn btn-outline-secondary' do
                  %i.fa.fa-fw.fa-arrow-left
                  一覧に戻る
          .col-md-4
            .sticky-top{style: 'z-index: 0'}
              .card.hidden-md-down
                .card-body
                  .alert.alert-primary.text-center
                    販売価格
                    %span.ml-3= jpy(@item.price, suffix: true)
                    %span.small (税抜)
                  - if @item.remarks.present?
                    %p.text-justify= @item.remarks
                  .text-center.mt-3
                    = render 'favorites/button', item: @item, favorite: favorite
                    = render 'carts/button', item: @item
  .operation_sp.view_sp
    .fixed-bottom
      .card
        .card-body
          .pull-left
            .alert.alert-primary.mb-0.mt-2
              %span.small 販売価格:
              = jpy(@item.price, suffix: true)
              %span.small (税抜)
          .pull-right
            = render 'favorites/button', item: @item, favorite: favorite, button_size: 'bmd-btn-fab-sm'
            = render 'carts/button', item: @item, button_size: 'bmd-btn-fab-sm'
- content_for :javascript do
  :javascript
    $(function () {
      $('[data-toggle="tooltip"]').tooltip({
        delay: { "show": 200, "hide": 100 }
      });

      $(window).on("scroll", function() {
        var scrollHeight = $(document).height();
        var scrollPosition = $(window).height() + $(window).scrollTop();
        if ((scrollHeight - scrollPosition) / scrollHeight === 0) {
          $('.operation_sp').hide();
        } else {
          $('.operation_sp').show();
        }
      });
    });